{"version":3,"file":"index.production.js","sources":["../../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../../../../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../../../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../../../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../../../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../../../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../../../predict-core/dist/esm/createZone.js","../../../predict-core/dist/esm/lib/invariant.js","../../../predict-core/dist/esm/lib/unwrapPrediction.js","../../../predict-core/dist/esm/predict.js","../../../predict-core/dist/esm/lib/computeCartAbandonment.js","../../../../node_modules/dequal/lite/index.mjs","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","../../../../node_modules/use-sync-external-store/shim/index.js","../../src/lib/PredictContext.ts","../../../../node_modules/@babel/runtime/helpers/esm/extends.js","../../src/lib/PredictZoneContext.tsx","../../src/lib/usePredictContext.ts","../../src/usePredict.ts","../../src/lib/useStableValue.ts","../../src/Predict.tsx","../../src/PredictZone.tsx","../../src/usePredictZone.tsx","../../src/version.ts"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export var zoneCounterRef = {\n  current: 0\n};\nexport function createZone(_ref) {\n  var id = _ref.id,\n      name = _ref.name,\n      _ref$active = _ref.active,\n      active = _ref$active === void 0 ? true : _ref$active,\n      _ref$happened = _ref.happened,\n      happened = _ref$happened === void 0 ? false : _ref$happened;\n  var zone = {\n    id: id || \"\".concat(name, \"-\").concat(++zoneCounterRef.current),\n    name: name,\n    active: active,\n    happened: happened\n  };\n  return zone;\n}","/**\n * Throws an error if the condition is not met.\n *\n * The error is exhaustive in development, and becomes generic in production.\n *\n * This is used to make development a better experience to provide guidance as\n * to where the error comes from.\n */\nexport function invariant(condition, message) {\n  if (condition) {\n    return;\n  }\n  /* istanbul ignore next */\n\n\n  if (!(process.env.NODE_ENV !== 'production')) {\n    throw new Error('Invariant failed');\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    throw new Error(\"[Predict] \".concat(typeof message === 'function' ? message() : message));\n  }\n}","import { warn } from './warn';\n\nfunction isModelError(prediction) {\n  return Boolean(prediction.error);\n}\n/**\n * Unwraps the prediction value, or falls back when it's unavailable.\n *\n * If the model is unavailable, it returns the fallback and triggers a warning.\n */\n\n\nexport function unwrapPrediction(predictions, model, fallback) {\n  var prediction = predictions && predictions[model];\n\n  if (!prediction) {\n    return fallback;\n  }\n\n  if (isModelError(prediction)) {\n    process.env.NODE_ENV !== 'production' ? warn(false, prediction.error) : void 0;\n    return fallback;\n  }\n\n  return prediction.value;\n}","import { computeCartAbandonment } from './lib/computeCartAbandonment';\nimport { invariant } from './lib/invariant';\nimport { logDebug } from './lib/logDebug';\nimport { unwrapPrediction } from './lib/unwrapPrediction';\nimport { initPredictTools } from './tools';\nimport { version } from './version';\nexport function predict(params) {\n  var PREDICT_TOOLS_ENABLED = (process.env.NODE_ENV !== 'production' || process.env.PREDICT_TOOLS === 'true') && typeof window !== 'undefined';\n  var subscribers = [];\n  var userProfile = params.userProfile;\n  var zones = [];\n  var isPersonificationEnabled = false;\n  /**\n   * Maintains a queue of updates that need to be applied once the personification ends.\n   *\n   * We ignore `update()` calls when personifying to give precedence to the personified user profile.\n   * So we need to apply the updates at the end of the personification to ensure\n   * the latest changes are reflected.\n   */\n\n  var pendingUpdates = [];\n\n  var applyUpdate = function applyUpdate(nextParams) {\n    if (nextParams.userProfile) {\n      userProfile = nextParams.userProfile;\n    }\n  };\n\n  var update = function update(nextParams) {\n    if (PREDICT_TOOLS_ENABLED) {\n      if (isPersonificationEnabled) {\n        logDebug('Skipped update because the Predict Tools extension is personifying the user.', nextParams);\n        pendingUpdates.push(nextParams);\n        return;\n      }\n    }\n\n    applyUpdate(nextParams);\n    notify('UPDATED');\n  };\n\n  var getUserProfile = function getUserProfile() {\n    return userProfile;\n  };\n\n  var getSegments = function getSegments() {\n    return Object.entries(userProfile.segments || {}).reduce(function (acc, segment) {\n      // We don't use array destructuring because Babel transformations blow\n      // up the bundle size. Once we have more code that requires this syntax,\n      // we can consider upgrading to:\n      // const [type, names] = segment; // not used for bundle optimization\n      var type = segment[0];\n      var names = segment[1];\n      var segmentsInType = names.map(function (name) {\n        return {\n          name: name,\n          type: type\n        };\n      });\n      segmentsInType.forEach(function (segmentInType) {\n        acc.push(segmentInType);\n      });\n      return acc;\n    }, []);\n  };\n\n  var getProperties = function getProperties() {\n    return Object.entries(userProfile.properties || {}).reduce(function (acc, group) {\n      // const [type, properties] = group; // not used for bundle optimization\n      var type = group[0];\n      var properties = group[1];\n      var propertiesInType = Object.entries(properties || {}).map(function (property) {\n        // const [key, value] = property; // not used for bundle optimization\n        var key = property[0];\n        var value = property[1];\n        return {\n          name: key,\n          value: value,\n          type: type\n        };\n      });\n      propertiesInType.forEach(function (propertyInType) {\n        acc.push(propertyInType);\n      });\n      return acc;\n    }, []);\n  };\n\n  var getAffinities = function getAffinities() {\n    return unwrapPrediction(userProfile.predictions, 'affinities', []);\n  };\n\n  var getFunnelStage = function getFunnelStage() {\n    return unwrapPrediction(userProfile.predictions, 'funnel_stage', []);\n  };\n\n  var getOrderValue = function getOrderValue() {\n    return unwrapPrediction(userProfile.predictions, 'order_value', undefined);\n  };\n\n  var getCartAbandonment = function getCartAbandonment() {\n    return computeCartAbandonment(getFunnelStage());\n  };\n\n  var getZones = function getZones() {\n    return zones;\n  };\n\n  var addZone = function addZone(newZone) {\n    invariant(!zones.some(function (zone) {\n      return zone.id === newZone.id;\n    }), \"Cannot add zone with ID \\\"\".concat(newZone.id, \"\\\" because it already exists.\"));\n    zones.push(newZone);\n    notify('ZONE_ADDED');\n    return newZone;\n  };\n\n  var removeZone = function removeZone(zone) {\n    var zoneIndex = zones.findIndex(function (x) {\n      return x.id === zone.id;\n    });\n    invariant(zoneIndex !== -1, \"Cannot remove zone with ID \\\"\".concat(zone.id, \"\\\" because it doesn't exist.\"));\n    zones.splice(zoneIndex, 1);\n    notify('ZONE_REMOVED');\n  };\n\n  var updateZone = function updateZone(zone) {\n    var _zone$name, _zone$active, _zone$happened;\n\n    var zoneIndex = zones.findIndex(function (x) {\n      return x.id === zone.id;\n    });\n    invariant(zoneIndex !== -1, \"Cannot update zone with ID \\\"\".concat(zone.id, \"\\\" because it doesn't exist.\"));\n    var prevZone = zones[zoneIndex];\n    var updatedZone = {\n      id: zone.id,\n      name: (_zone$name = zone.name) !== null && _zone$name !== void 0 ? _zone$name : prevZone.name,\n      active: (_zone$active = zone.active) !== null && _zone$active !== void 0 ? _zone$active : prevZone.active,\n      happened: (_zone$happened = zone.happened) !== null && _zone$happened !== void 0 ? _zone$happened : prevZone.happened\n    };\n    zones[zoneIndex] = updatedZone;\n    notify('ZONE_UPDATED');\n    return updatedZone;\n  };\n\n  var subscribe = function subscribe(subscriber) {\n    subscribers.push(subscriber);\n    return function () {\n      subscribers = subscribers.filter(function (x) {\n        return x !== subscriber;\n      });\n    };\n  };\n\n  function notify(eventType) {\n    subscribers.forEach(function (subscriber) {\n      subscriber({\n        eventType: eventType,\n        affinities: getAffinities(),\n        cartAbandonment: getCartAbandonment(),\n        funnelStage: getFunnelStage(),\n        orderValue: getOrderValue(),\n        segments: getSegments(),\n        properties: getProperties(),\n        userProfile: getUserProfile(),\n        zones: getZones()\n      });\n    });\n  } // Predict Tools are enabled in development mode, or when the `PREDICT_TOOLS`\n  // environment variable is set. This is useful to use the web extension in\n  // staging environments.\n\n\n  if (PREDICT_TOOLS_ENABLED) {\n    initPredictTools({\n      version: version,\n      subscribe: subscribe,\n      getContext: function getContext() {\n        return {\n          affinities: getAffinities(),\n          cartAbandonment: getCartAbandonment(),\n          funnelStage: getFunnelStage(),\n          orderValue: getOrderValue(),\n          segments: getSegments(),\n          properties: getProperties(),\n          userProfile: getUserProfile(),\n          zones: getZones()\n        };\n      },\n      startPersonification: function startPersonification(_ref) {\n        var userProfileToPersonify = _ref.userProfile;\n        pendingUpdates.push({\n          userProfile: userProfile\n        });\n        update({\n          userProfile: userProfileToPersonify\n        });\n        isPersonificationEnabled = true;\n      },\n      endPersonification: function endPersonification() {\n        isPersonificationEnabled = false;\n\n        while (pendingUpdates.length > 0) {\n          var updateParams = pendingUpdates.shift();\n          applyUpdate(updateParams);\n        } // We trigger an update to notify subscribers.\n\n\n        update({});\n      }\n    });\n  }\n\n  var api = {\n    getAffinities: getAffinities,\n    getFunnelStage: getFunnelStage,\n    getOrderValue: getOrderValue,\n    getCartAbandonment: getCartAbandonment,\n    getSegments: getSegments,\n    getProperties: getProperties,\n    getUserProfile: getUserProfile,\n    getZones: getZones,\n    update: update,\n    addZone: addZone,\n    removeZone: removeZone,\n    updateZone: updateZone,\n    subscribe: subscribe\n  };\n  return api;\n}","export function computeCartAbandonment(funnelStage) {\n  var addToCartPrediction = funnelStage.find( // The pipeline doesn't normalize the funnel stage values so we check it\n  // against lowercase to support more cases.\n  function (x) {\n    return x.name.toLocaleLowerCase() === 'add_to_cart';\n  }); // The `add_to_cart` funnel stage doesn't exist so that's not a cart abandonment\n  // scenario.\n\n  if (!addToCartPrediction) {\n    return 0;\n  }\n\n  if (addToCartPrediction.probability >= // We don't use spread in the function call because Babel transformations blow\n  // up the bundle size. Once we have more code that requires this syntax,\n  // we can consider upgrading to:\n  // Math.max(...funnelStage.map((stage) => stage.probability)) // not used for bundle optimization\n  Math.max.apply(null, funnelStage.map(function (stage) {\n    return stage.probability;\n  }))) {\n    // The `add_to_cart` prediction is the prediction that has the highest probability,\n    // so this is a cart abandonment scenario.\n    return 1;\n  } else {\n    return 0;\n  }\n}","var has = Object.prototype.hasOwnProperty;\n\nexport function dequal(foo, bar) {\n\tvar ctor, len;\n\tif (foo === bar) return true;\n\n\tif (foo && bar && (ctor=foo.constructor) === bar.constructor) {\n\t\tif (ctor === Date) return foo.getTime() === bar.getTime();\n\t\tif (ctor === RegExp) return foo.toString() === bar.toString();\n\n\t\tif (ctor === Array) {\n\t\t\tif ((len=foo.length) === bar.length) {\n\t\t\t\twhile (len-- && dequal(foo[len], bar[len]));\n\t\t\t}\n\t\t\treturn len === -1;\n\t\t}\n\n\t\tif (!ctor || typeof foo === 'object') {\n\t\t\tlen = 0;\n\t\t\tfor (ctor in foo) {\n\t\t\t\tif (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;\n\t\t\t\tif (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) return false;\n\t\t\t}\n\t\t\treturn Object.keys(bar).length === len;\n\t\t}\n\t}\n\n\treturn foo !== foo && bar !== bar;\n}\n","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","import {\n  type Affinity,\n  type FunnelStage,\n  type OrderValue,\n  type PredictCoreApi,\n  type Property,\n  type Segment,\n  type UserProfile,\n  type Zone,\n} from '@algolia/predict-core';\nimport { createContext } from 'react';\n\nexport type PredictReactApi = Omit<\n  PredictCoreApi,\n  | 'getAffinities'\n  | 'getFunnelStage'\n  | 'getOrderValue'\n  | 'getCartAbandonment'\n  | 'getSegments'\n  | 'getProperties'\n  | 'getUserProfile'\n  | 'getZones'\n  | 'update'\n> & {\n  userProfile: UserProfile;\n  affinities: Affinity[];\n  funnelStage: FunnelStage[];\n  orderValue: OrderValue | undefined;\n  cartAbandonment: number;\n  segments: Segment[];\n  properties: Property[];\n  zones: Zone[];\n};\n\nexport const PredictContext = createContext<PredictReactApi | null>(null);\n\nif (__DEV__) {\n  PredictContext.displayName = 'Predict';\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import { createContext } from 'react';\n\ntype PredictZoneContextApi = {\n  dismissZone: () => void;\n};\n\nexport const PredictZoneContext = createContext<PredictZoneContextApi | null>(\n  null\n);\n\nif (__DEV__) {\n  PredictZoneContext.displayName = 'PredictZone';\n}\n","import { invariant } from '@algolia/predict-core';\nimport { useContext } from 'react';\n\nimport { PredictContext } from './PredictContext';\n\nexport function usePredictContext({\n  errorMessage = 'The Predict APIs must be used within the <Predict> provider.',\n} = {}) {\n  const context = useContext(PredictContext);\n\n  invariant(context !== null, errorMessage);\n\n  return context;\n}\n","import { type PredictReactApi } from './lib/PredictContext';\nimport { usePredictContext } from './lib/usePredictContext';\nimport { useStableValue } from './lib/useStableValue';\n\nexport type PredictApi = Omit<\n  PredictReactApi,\n  'addZone' | 'removeZone' | 'updateZone' | 'subscribe'\n>;\n\nexport function usePredict(): PredictApi {\n  const { addZone, removeZone, updateZone, subscribe, ...rest } =\n    usePredictContext({\n      errorMessage:\n        '`usePredict()` must be used within the <Predict> provider.',\n    });\n  const predictApi = useStableValue(rest);\n\n  return predictApi;\n}\n","import { dequal } from 'dequal/lite';\nimport { useState } from 'react';\n\nexport function useStableValue<TValue>(value: TValue) {\n  const [stableValue, setStableValue] = useState<TValue>(() => value);\n\n  if (!dequal(stableValue, value)) {\n    setStableValue(value);\n  }\n\n  return stableValue;\n}\n","import {\n  predict,\n  warn,\n  type PredictCoreApi,\n  type UserProfile,\n} from '@algolia/predict-core';\nimport { dequal } from 'dequal/lite';\nimport React, {\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { PredictContext, PredictReactApi } from './lib/PredictContext';\n\nexport type PredictProps = {\n  userProfile: UserProfile;\n  suppressExperimentalWarning?: boolean;\n  children: ReactNode;\n};\n\nexport function Predict({\n  userProfile,\n  suppressExperimentalWarning = false,\n  children,\n}: PredictProps) {\n  const predictRef = useRef<PredictCoreApi | null>(null);\n\n  if (predictRef.current === null) {\n    predictRef.current = predict({ userProfile });\n  }\n\n  const [predictApi, setPredictApi] = useState<PredictReactApi>(() => ({\n    userProfile: predictRef.current!.getUserProfile(),\n    affinities: predictRef.current!.getAffinities(),\n    funnelStage: predictRef.current!.getFunnelStage(),\n    orderValue: predictRef.current!.getOrderValue(),\n    cartAbandonment: predictRef.current!.getCartAbandonment(),\n    segments: predictRef.current!.getSegments(),\n    properties: predictRef.current!.getProperties(),\n    zones: predictRef.current!.getZones(),\n    addZone: predictRef.current!.addZone,\n    removeZone: predictRef.current!.removeZone,\n    updateZone: predictRef.current!.updateZone,\n    subscribe: predictRef.current!.subscribe,\n  }));\n\n  const [prevUserProfile, setPrevUserProfile] = useState(() =>\n    predictRef.current!.getUserProfile()\n  );\n  if (!dequal(userProfile, prevUserProfile)) {\n    predictRef.current.update({ userProfile });\n    setPrevUserProfile(userProfile);\n  }\n\n  const store = useSyncExternalStore(\n    useCallback(\n      () =>\n        predictRef.current!.subscribe(({ eventType, ...state }) => {\n          // We manage zone updates directly with the React state, so we don't\n          // need to listen to this event.\n          if (eventType !== 'ZONE_UPDATED') {\n            setPredictApi((prev) => ({ ...prev, ...state }));\n          }\n        }),\n      []\n    ),\n    () => predictApi,\n    () => predictApi\n  );\n\n  useEffect(() => {\n    warn(\n      suppressExperimentalWarning,\n      'This version is experimental and not production-ready.\\n\\n' +\n        'Please report any bugs at https://github.com/algolia/predict/issues/new\\n\\n' +\n        '(To disable this warning, pass `suppressExperimentalWarning` to <Predict>.)'\n    );\n  }, [suppressExperimentalWarning]);\n\n  return (\n    <PredictContext.Provider value={store}>{children}</PredictContext.Provider>\n  );\n}\n","import { createZone, type Zone } from '@algolia/predict-core';\nimport React, {\n  type ComponentProps,\n  type ReactNode,\n  useCallback,\n  useMemo,\n  useState,\n} from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { PredictZoneContext } from './lib/PredictZoneContext';\nimport { usePredictContext } from './lib/usePredictContext';\nimport { type PredictApi, usePredict } from './usePredict';\n\nexport type PredictZoneProps = Omit<\n  ComponentProps<'div'>,\n  'onMouseDown' | 'onTouchStart'\n> & {\n  id?: Zone['id'];\n  name: Zone['name'];\n  segment?: string | ((api: PredictApi) => boolean);\n  children: ReactNode;\n  fallback?: ReactNode;\n};\n\nexport function PredictZone({\n  id,\n  children,\n  name,\n  segment,\n  fallback = null,\n  ...props\n}: PredictZoneProps) {\n  const { addZone, removeZone, updateZone } = usePredictContext({\n    errorMessage:\n      'The <PredictZone> must be mounted within the <Predict> provider.',\n  });\n  const predictApi = usePredict();\n  const [zone, setZone] = useState(() => {\n    const active =\n      // eslint-disable-next-line no-nested-ternary\n      typeof segment === 'function'\n        ? segment(predictApi)\n        : segment\n        ? Boolean(predictApi.segments.find((s) => s.name === segment))\n        : true;\n    return createZone({ id, name, active });\n  });\n  const [isDismissed, setIsDismissed] = useState(false);\n\n  const [prevName, setPrevName] = useState(zone.name);\n  if (name !== prevName) {\n    setPrevName(name);\n    updateZone({ id: zone.id, name });\n  }\n\n  if (!isDismissed) {\n    const active =\n      // eslint-disable-next-line no-nested-ternary\n      typeof segment === 'function'\n        ? segment(predictApi)\n        : segment\n        ? Boolean(predictApi.segments.find((s) => s.name === segment))\n        : zone.active;\n\n    if (active !== zone.active) {\n      setZone((prev) => ({ ...prev, active }));\n      updateZone({ id: zone.id, active });\n    }\n  }\n\n  const zoneApi = useMemo(\n    () => ({\n      dismissZone: () => {\n        setZone((prev) => ({ ...prev, active: false, happened: true }));\n        updateZone({ id: zone.id, active: false, happened: true });\n        setIsDismissed(true);\n      },\n    }),\n    [updateZone, zone.id]\n  );\n\n  const zoneStore = useSyncExternalStore(\n    useCallback(() => {\n      addZone(zone);\n\n      return () => {\n        removeZone(zone);\n      };\n      // We don't track zone changes because we update the zone in the store via\n      // `updateZone()`.\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [addZone, removeZone]),\n    () => zoneApi,\n    () => zoneApi\n  );\n\n  if (!zone.active) {\n    return <>{fallback}</>;\n  }\n\n  return (\n    <PredictZoneContext.Provider value={zoneStore}>\n      <div\n        {...props}\n        data-predictzoneid={zone.id}\n        onMouseDown={() => {\n          setZone((prev) => ({ ...prev, happened: true }));\n          updateZone({ id: zone.id, happened: true });\n        }}\n        onTouchStart={() => {\n          setZone((prev) => ({ ...prev, happened: true }));\n          updateZone({ id: zone.id, happened: true });\n        }}\n      >\n        {children}\n      </div>\n    </PredictZoneContext.Provider>\n  );\n}\n","import { invariant } from '@algolia/predict-core';\nimport { useContext } from 'react';\n\nimport { PredictZoneContext } from './lib/PredictZoneContext';\n\nexport function usePredictZone() {\n  const context = useContext(PredictZoneContext);\n\n  invariant(\n    context !== null,\n    '`usePredictZone()` must be used within a <PredictZone>.'\n  );\n\n  return context;\n}\n","export const version = '1.6.1';\n"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_objectWithoutProperties","source","excluded","i","target","sourceKeys","keys","length","indexOf","objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","_arrayLikeToArray","arr","len","arr2","Array","_slicedToArray","isArray","arrayWithHoles","_i","Symbol","iterator","_s","_e","_arr","_n","_d","next","done","push","err","iterableToArrayLimit","o","minLen","arrayLikeToArray","n","toString","slice","constructor","name","from","test","unsupportedIterableToArray","TypeError","nonIterableRest","zoneCounterRef","current","invariant","condition","message","Error","unwrapPrediction","predictions","model","fallback","prediction","Boolean","error","isModelError","predict","params","subscribers","userProfile","zones","getUserProfile","getSegments","entries","segments","reduce","acc","segment","type","map","forEach","segmentInType","getProperties","properties","group","property","propertyInType","getAffinities","getFunnelStage","getOrderValue","undefined","getCartAbandonment","funnelStage","addToCartPrediction","find","x","toLocaleLowerCase","probability","Math","max","apply","stage","getZones","notify","eventType","subscriber","affinities","cartAbandonment","orderValue","update","nextParams","applyUpdate","addZone","newZone","some","zone","id","concat","removeZone","zoneIndex","findIndex","splice","updateZone","_zone$name","_zone$active","_zone$happened","prevZone","updatedZone","active","happened","subscribe","filter","has","hasOwnProperty","dequal","foo","bar","ctor","Date","getTime","RegExp","e","require$$0","k","is","a","b","l","useState","m","useEffect","useLayoutEffect","p","useDebugValue","r","getSnapshot","d","f","u","window","document","createElement","inst","c","g","useSyncExternalStoreShim_production_min","useSyncExternalStore","module","exports","PredictContext","createContext","_extends","assign","arguments","this","PredictZoneContext","usePredictContext","_ref","errorMessage","context","useContext","usePredict","_usePredictContext","_useState2","stableValue","setStableValue","rest","_excluded","_ref$suppressExperime","suppressExperimentalWarning","children","predictRef","useRef","predictApi","setPredictApi","_useState4","prevUserProfile","setPrevUserProfile","store","useCallback","_ref2","state","prev","React","Provider","_ref$fallback","props","s","_ref$active","_ref$happened","createZone","_useState","setZone","isDismissed","setIsDismissed","_useState6","prevName","setPrevName","_objectSpread","zoneApi","useMemo","dismissZone","zoneStore","onMouseDown","onTouchStart","Fragment"],"mappings":"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"}