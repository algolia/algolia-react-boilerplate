/*! @algolia/predict-core 1.6.1 | MIT License | Â© Algolia, Inc. and contributors | https://github.com/algolia/predict */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self)["@algolia/predict-core"]={})}(this,(function(e){"use strict";var n={current:0};function t(e,n){if(!e)throw new Error("Invariant failed")}function r(e,n){}function i(e,n,t){var r=e&&e[n];return r?function(e){return Boolean(e.error)}(r)?t:r.value:t}e.createZone=function(e){var t=e.id,r=e.name,i=e.active,o=void 0===i||i,u=e.happened,a=void 0!==u&&u;return{id:t||"".concat(r,"-").concat(++n.current),name:r,active:o,happened:a}},e.invariant=t,e.predict=function(e){var n=[],r=e.userProfile,o=[],u=function(){return r},a=function(){return Object.entries(r.segments||{}).reduce((function(e,n){var t=n[0];return n[1].map((function(e){return{name:e,type:t}})).forEach((function(n){e.push(n)})),e}),[])},c=function(){return Object.entries(r.properties||{}).reduce((function(e,n){var t=n[0],r=n[1];return Object.entries(r||{}).map((function(e){return{name:e[0],value:e[1],type:t}})).forEach((function(n){e.push(n)})),e}),[])},f=function(){return i(r.predictions,"affinities",[])},d=function(){return i(r.predictions,"funnel_stage",[])},s=function(){return i(r.predictions,"order_value",void 0)},p=function(){return e=d(),(n=e.find((function(e){return"add_to_cart"===e.name.toLocaleLowerCase()})))&&n.probability>=Math.max.apply(null,e.map((function(e){return e.probability})))?1:0;var e,n},l=function(){return o};function v(e){n.forEach((function(n){n({eventType:e,affinities:f(),cartAbandonment:p(),funnelStage:d(),orderValue:s(),segments:a(),properties:c(),userProfile:u(),zones:l()})}))}return{getAffinities:f,getFunnelStage:d,getOrderValue:s,getCartAbandonment:p,getSegments:a,getProperties:c,getUserProfile:u,getZones:l,update:function(e){!function(e){e.userProfile&&(r=e.userProfile)}(e),v("UPDATED")},addZone:function(e){return t(!o.some((function(n){return n.id===e.id})),'Cannot add zone with ID "'.concat(e.id,'" because it already exists.')),o.push(e),v("ZONE_ADDED"),e},removeZone:function(e){var n=o.findIndex((function(n){return n.id===e.id}));t(-1!==n,'Cannot remove zone with ID "'.concat(e.id,"\" because it doesn't exist.")),o.splice(n,1),v("ZONE_REMOVED")},updateZone:function(e){var n,r,i,u=o.findIndex((function(n){return n.id===e.id}));t(-1!==u,'Cannot update zone with ID "'.concat(e.id,"\" because it doesn't exist."));var a=o[u],c={id:e.id,name:null!==(n=e.name)&&void 0!==n?n:a.name,active:null!==(r=e.active)&&void 0!==r?r:a.active,happened:null!==(i=e.happened)&&void 0!==i?i:a.happened};return o[u]=c,v("ZONE_UPDATED"),c},subscribe:function(e){return n.push(e),function(){n=n.filter((function(n){return n!==e}))}}}},e.version="1.6.1",e.warn=r,e.warnCache={current:{}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.production.js.map
