/*! @algolia/predict-core 1.4.0 | MIT License | Â© Algolia, Inc. and contributors | https://github.com/algolia/predict */
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((n="undefined"!=typeof globalThis?globalThis:n||self)["@algolia/predict-core"]={})}(this,(function(n){"use strict";var e={current:0};function t(n,e){if(!n)throw new Error("Invariant failed")}function r(n,e){}function i(n,e,t){var r=n&&n[e];return r?function(n){return Boolean(n.error)}(r)?("production"!==process.env.NODE_ENV&&r.error,t):r.value:t}n.createZone=function(n){var t=n.id,r=n.name,i=n.active,o=void 0===i||i,u=n.happened,a=void 0!==u&&u;return{id:t||"".concat(r,"-").concat(++e.current),name:r,active:o,happened:a}},n.invariant=t,n.predict=function(n){var e=[],r=n.userProfile,o=[],u=function(){return r},a=function(){return Object.entries(r.segments||{}).reduce((function(n,e){var t=e[0];return e[1].map((function(n){return{name:n,type:t}})).forEach((function(e){n.push(e)})),n}),[])},c=function(){return i(r.predictions,"affinities",[])},f=function(){return i(r.predictions,"funnel_stage",[])},d=function(){return i(r.predictions,"order_value",void 0)},s=function(){return n=f(),e=n.find((function(n){return"add_to_cart"===n.name})),t=n.find((function(n){return"transaction"===n.name})),e&&t&&e.probability>t.probability?1:0;var n,e,t},p=function(){return o};function l(n){e.forEach((function(e){e({eventType:n,affinities:c(),cartAbandonment:s(),funnelStage:f(),orderValue:d(),segments:a(),userProfile:u(),zones:p()})}))}return{getAffinities:c,getFunnelStage:f,getOrderValue:d,getCartAbandonment:s,getSegments:a,getUserProfile:u,getZones:p,update:function(n){n.userProfile&&(r=n.userProfile),l("UPDATED")},addZone:function(n){return o.push(n),l("ZONE_ADDED"),n},removeZone:function(n){var e=o.findIndex((function(e){return e.id===n.id}));t(-1!==e,'Cannot remove zone with ID "'.concat(n.id,"\" because it doesn't exist.")),o.splice(e,1),l("ZONE_REMOVED")},updateZone:function(n){var e,r,i,u=o.findIndex((function(e){return e.id===n.id}));t(-1!==u,'Cannot update zone with ID "'.concat(n.id,"\" because it doesn't exist."));var a=o[u],c={id:n.id,name:null!==(e=n.name)&&void 0!==e?e:a.name,active:null!==(r=n.active)&&void 0!==r?r:a.active,happened:null!==(i=n.happened)&&void 0!==i?i:a.happened};return o[u]=c,l("ZONE_UPDATED"),c},subscribe:function(n){return e.push(n),function(){e=e.filter((function(e){return e!==n}))}}}},n.version="1.4.0",n.warn=r,n.warnCache={current:{}},Object.defineProperty(n,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
