{"version":3,"file":"index.js","sources":["../../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../../../../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../../../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../../../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../../../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../../../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../../../predict-core/dist/esm/createZone.js","../../../predict-core/dist/esm/lib/invariant.js","../../../predict-core/dist/esm/lib/warn.js","../../../predict-core/dist/esm/lib/unwrapPrediction.js","../../../predict-core/dist/esm/tools/highlighter.js","../../../predict-core/dist/esm/tools/actions.js","../../../predict-core/dist/esm/tools/types.js","../../../predict-core/dist/esm/tools/init.js","../../../predict-core/dist/esm/predict.js","../../../predict-core/dist/esm/lib/computeCartAbandonment.js","../../../predict-core/dist/esm/version.js","../../../../node_modules/dequal/lite/index.mjs","../../../../node_modules/use-sync-external-store/shim/index.js","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.development.js","../../src/lib/PredictContext.ts","../../../../node_modules/@babel/runtime/helpers/esm/extends.js","../../src/lib/PredictZoneContext.tsx","../../src/lib/usePredictContext.ts","../../src/usePredict.ts","../../src/lib/useStableValue.ts","../../src/Predict.tsx","../../src/PredictZone.tsx","../../src/usePredictZone.tsx","../../src/version.ts"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export var zoneCounterRef = {\n  current: 0\n};\nexport function createZone(_ref) {\n  var id = _ref.id,\n      name = _ref.name,\n      _ref$active = _ref.active,\n      active = _ref$active === void 0 ? true : _ref$active,\n      _ref$happened = _ref.happened,\n      happened = _ref$happened === void 0 ? false : _ref$happened;\n  var zone = {\n    id: id || \"\".concat(name, \"-\").concat(++zoneCounterRef.current),\n    name: name,\n    active: active,\n    happened: happened\n  };\n  return zone;\n}","/**\n * Throws an error if the condition is not met.\n *\n * The error is exhaustive in development, and becomes generic in production.\n *\n * This is used to make development a better experience to provide guidance as\n * to where the error comes from.\n */\nexport function invariant(condition, message) {\n  if (condition) {\n    return;\n  }\n  /* istanbul ignore next */\n\n\n  if (!(process.env.NODE_ENV !== 'production')) {\n    throw new Error('Invariant failed');\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    throw new Error(\"[Predict] \".concat(typeof message === 'function' ? message() : message));\n  }\n}","/* eslint-disable no-console, no-empty */\nexport var warnCache = {\n  current: {}\n};\n/**\n * Logs a warning if the condition is not met.\n * This is used to log issues in development environment only.\n */\n\nexport function warn(condition, message) {\n  /* istanbul ignore next */\n  if (!(process.env.NODE_ENV !== 'production')) {\n    return;\n  }\n\n  if (condition) {\n    return;\n  }\n\n  var sanitizedMessage = message.trim();\n  var hasAlreadyPrinted = warnCache.current[sanitizedMessage];\n\n  if (!hasAlreadyPrinted) {\n    warnCache.current[sanitizedMessage] = true;\n    var warning = \"[Predict] \".concat(sanitizedMessage);\n    console.warn(warning);\n\n    try {\n      // Welcome to debugging Predict.\n      //\n      // This error was thrown as a convenience so that you can find the source\n      // of the warning that appears in the console by enabling \"Pause on exceptions\"\n      // in your debugger.\n      throw new Error(warning);\n    } catch (error) {}\n  }\n}","import { warn } from './warn';\n\nfunction isModelError(prediction) {\n  return Boolean(prediction.error);\n}\n/**\n * Unwraps the prediction value, or falls back when it's unavailable.\n *\n * If the model is unavailable, it returns the fallback and triggers a warning.\n */\n\n\nexport function unwrapPrediction(predictions, model, fallback) {\n  var prediction = predictions && predictions[model];\n\n  if (!prediction) {\n    return fallback;\n  }\n\n  if (isModelError(prediction)) {\n    process.env.NODE_ENV !== 'production' ? warn(false, prediction.error) : void 0;\n    return fallback;\n  }\n\n  return prediction.value;\n}","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nexport function createElementHighlighter() {\n  var highlights = {};\n\n  function unselect(id) {\n    var overlay = highlights[id];\n\n    if (overlay) {\n      document.body.removeChild(overlay);\n      delete highlights[id];\n    }\n  }\n\n  return {\n    select: function select(referenceElement, props) {\n      if (highlights[props.id]) {\n        // Ignore if the element is already highlighted\n        return;\n      }\n\n      var _referenceElement$get = referenceElement.getBoundingClientRect(),\n          height = _referenceElement$get.height,\n          width = _referenceElement$get.width,\n          top = _referenceElement$get.top,\n          left = _referenceElement$get.left;\n\n      var overlay = document.createElement('div');\n      overlay.setAttribute('data-predicthighlightid', props.id);\n\n      var style = _objectSpread(_objectSpread({}, props.style), {}, {\n        top: \"\".concat(top, \"px\"),\n        left: \"\".concat(left, \"px\"),\n        height: \"\".concat(height, \"px\"),\n        width: \"\".concat(width, \"px\")\n      });\n\n      Object.keys(style).forEach(function (attribute) {\n        overlay.style[attribute] = style[attribute];\n      });\n      highlights[props.id] = overlay;\n      document.body.appendChild(overlay);\n    },\n    unselect: unselect,\n    unselectAll: function unselectAll() {\n      Object.keys(highlights).forEach(function (id) {\n        return unselect(id);\n      });\n    }\n  };\n}","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { invariant } from '../lib/invariant';\nimport { createElementHighlighter } from './highlighter';\nvar highlighter = createElementHighlighter();\nexport function runAction(message, _ref) {\n  var init = _ref.init;\n  var type = message.type,\n      data = message.data;\n  var actions = {\n    'request-init': function requestInit() {\n      // Answer back to the Predict Tools that just opened.\n      init();\n    },\n    'request-highlight-zone': function requestHighlightZone(_ref2) {\n      var zoneId = _ref2.zoneId,\n          params = _ref2.params;\n      var predictZoneElement = document.querySelector(\"[data-predictzoneid=\\\"\".concat(zoneId, \"\\\"]\"));\n\n      if (predictZoneElement) {\n        highlighter.select(predictZoneElement, _objectSpread({\n          id: zoneId\n        }, params));\n      }\n    },\n    'request-unhighlight-zone': function requestUnhighlightZone(_ref3) {\n      var zoneId = _ref3.zoneId;\n      highlighter.unselect(zoneId);\n    },\n    'request-scroll-to-zone': function requestScrollToZone(_ref4) {\n      var zoneId = _ref4.zoneId;\n      var predictZoneElement = document.querySelector(\"[data-predictzoneid=\\\"\".concat(zoneId, \"\\\"]\"));\n\n      if (predictZoneElement) {\n        var scrollIntoView = predictZoneElement.scrollIntoViewIfNeeded.bind(predictZoneElement) || predictZoneElement.scrollIntoView.bind(predictZoneElement);\n        scrollIntoView();\n      }\n    },\n    disconnect: function disconnect() {\n      highlighter.unselectAll();\n    }\n  };\n  var action = actions[type];\n  invariant(Boolean(action), \"The Predict Tools event \\\"\".concat(type, \"\\\" is not implemented.\"));\n  action(data);\n}","export var PREDICT_TO_EXTENSION = 'predict-to-extension';\nexport var EXTENSION_TO_PREDICT = 'extension-to-predict';","import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _excluded = [\"eventType\"];\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { runAction } from './actions';\nimport { EXTENSION_TO_PREDICT, PREDICT_TO_EXTENSION } from './types';\n\nfunction sendMessage(message) {\n  window.postMessage(_objectSpread({\n    source: PREDICT_TO_EXTENSION\n  }, message), '*');\n}\n\nexport function initPredictTools(_ref) {\n  var version = _ref.version,\n      getContext = _ref.getContext,\n      subscribe = _ref.subscribe;\n\n  /**\n   * Notifies the Predict Tools from the Predict context.\n   */\n  function init() {\n    sendMessage({\n      type: 'init',\n      data: {\n        version: version,\n        context: getContext()\n      }\n    });\n  } // We initialize the Predict Tools right away if the browser's DevTools are open.\n\n\n  init(); // And we send any state change updates to the Predict Tools.\n\n  subscribe(function (_ref2) {\n    var eventType = _ref2.eventType,\n        context = _objectWithoutProperties(_ref2, _excluded);\n\n    sendMessage({\n      type: 'state-change',\n      data: {\n        version: version,\n        context: context\n      }\n    });\n  }); // Then, we listen to messages coming from the Predict Tools.\n\n  window.addEventListener('message', function (event) {\n    if (event.data.source === EXTENSION_TO_PREDICT) {\n      runAction(event.data, {\n        init: init\n      });\n    }\n  });\n}","import { computeCartAbandonment } from './lib/computeCartAbandonment';\nimport { invariant } from './lib/invariant';\nimport { unwrapPrediction } from './lib/unwrapPrediction';\nimport { initPredictTools } from './tools';\nimport { version } from './version';\nexport function predict(params) {\n  var subscribers = [];\n  var userProfile = params.userProfile;\n  var zones = [];\n\n  var update = function update(nextParams) {\n    if (nextParams.userProfile) {\n      userProfile = nextParams.userProfile;\n    }\n\n    notify('UPDATED');\n  };\n\n  var getUserProfile = function getUserProfile() {\n    return userProfile;\n  };\n\n  var getSegments = function getSegments() {\n    return Object.entries(userProfile.segments || {}).reduce(function (acc, segment) {\n      // We don't use array destructuring because Babel transformations blow\n      // up the bundle size. Once we have more code that requires this syntax,\n      // we can consider upgrading to:\n      // const [type, names] = segment; // not used for bundle optimization\n      var type = segment[0];\n      var names = segment[1];\n      var segmentsInType = names.map(function (name) {\n        return {\n          name: name,\n          type: type\n        };\n      });\n      segmentsInType.forEach(function (segmentInType) {\n        acc.push(segmentInType);\n      });\n      return acc;\n    }, []);\n  };\n\n  var getAffinities = function getAffinities() {\n    return unwrapPrediction(userProfile.predictions, 'affinities', []);\n  };\n\n  var getFunnelStage = function getFunnelStage() {\n    return unwrapPrediction(userProfile.predictions, 'funnel_stage', []);\n  };\n\n  var getOrderValue = function getOrderValue() {\n    return unwrapPrediction(userProfile.predictions, 'order_value', undefined);\n  };\n\n  var getCartAbandonment = function getCartAbandonment() {\n    return computeCartAbandonment(getFunnelStage());\n  };\n\n  var getZones = function getZones() {\n    return zones;\n  };\n\n  var addZone = function addZone(newZone) {\n    zones.push(newZone);\n    notify('ZONE_ADDED');\n    return newZone;\n  };\n\n  var removeZone = function removeZone(zone) {\n    var zoneIndex = zones.findIndex(function (x) {\n      return x.id === zone.id;\n    });\n    invariant(zoneIndex !== -1, \"Cannot remove zone with ID \\\"\".concat(zone.id, \"\\\" because it doesn't exist.\"));\n    zones.splice(zoneIndex, 1);\n    notify('ZONE_REMOVED');\n  };\n\n  var updateZone = function updateZone(zone) {\n    var _zone$name, _zone$active, _zone$happened;\n\n    var zoneIndex = zones.findIndex(function (x) {\n      return x.id === zone.id;\n    });\n    invariant(zoneIndex !== -1, \"Cannot update zone with ID \\\"\".concat(zone.id, \"\\\" because it doesn't exist.\"));\n    var prevZone = zones[zoneIndex];\n    var updatedZone = {\n      id: zone.id,\n      name: (_zone$name = zone.name) !== null && _zone$name !== void 0 ? _zone$name : prevZone.name,\n      active: (_zone$active = zone.active) !== null && _zone$active !== void 0 ? _zone$active : prevZone.active,\n      happened: (_zone$happened = zone.happened) !== null && _zone$happened !== void 0 ? _zone$happened : prevZone.happened\n    };\n    zones[zoneIndex] = updatedZone;\n    notify('ZONE_UPDATED');\n    return updatedZone;\n  };\n\n  var subscribe = function subscribe(subscriber) {\n    subscribers.push(subscriber);\n    return function () {\n      subscribers = subscribers.filter(function (x) {\n        return x !== subscriber;\n      });\n    };\n  };\n\n  function notify(eventType) {\n    subscribers.forEach(function (subscriber) {\n      subscriber({\n        eventType: eventType,\n        affinities: getAffinities(),\n        cartAbandonment: getCartAbandonment(),\n        funnelStage: getFunnelStage(),\n        orderValue: getOrderValue(),\n        segments: getSegments(),\n        userProfile: getUserProfile(),\n        zones: getZones()\n      });\n    });\n  } // Predict Tools are enabled in development mode, or when the `PREDICT_TOOLS`\n  // environment variable is set. This is useful to use the web extension in\n  // staging environments.\n\n\n  if ((process.env.NODE_ENV !== 'production' || process.env.PREDICT_TOOLS === 'true') && typeof window !== 'undefined') {\n    initPredictTools({\n      version: version,\n      subscribe: subscribe,\n      getContext: function getContext() {\n        return {\n          affinities: getAffinities(),\n          cartAbandonment: getCartAbandonment(),\n          funnelStage: getFunnelStage(),\n          orderValue: getOrderValue(),\n          segments: getSegments(),\n          userProfile: getUserProfile(),\n          zones: getZones()\n        };\n      }\n    });\n  }\n\n  var api = {\n    getAffinities: getAffinities,\n    getFunnelStage: getFunnelStage,\n    getOrderValue: getOrderValue,\n    getCartAbandonment: getCartAbandonment,\n    getSegments: getSegments,\n    getUserProfile: getUserProfile,\n    getZones: getZones,\n    update: update,\n    addZone: addZone,\n    removeZone: removeZone,\n    updateZone: updateZone,\n    subscribe: subscribe\n  };\n  return api;\n}","export function computeCartAbandonment(funnelStage) {\n  var addToCartFunnelStage = funnelStage.find(function (x) {\n    return x.name === 'add_to_cart';\n  });\n  var transactionFunnelStage = funnelStage.find(function (x) {\n    return x.name === 'transaction';\n  });\n\n  if (!addToCartFunnelStage || !transactionFunnelStage) {\n    return 0;\n  }\n\n  var probability = addToCartFunnelStage.probability > transactionFunnelStage.probability ? 1 : 0;\n  return probability;\n}","export var version = '1.4.0';","var has = Object.prototype.hasOwnProperty;\n\nexport function dequal(foo, bar) {\n\tvar ctor, len;\n\tif (foo === bar) return true;\n\n\tif (foo && bar && (ctor=foo.constructor) === bar.constructor) {\n\t\tif (ctor === Date) return foo.getTime() === bar.getTime();\n\t\tif (ctor === RegExp) return foo.toString() === bar.toString();\n\n\t\tif (ctor === Array) {\n\t\t\tif ((len=foo.length) === bar.length) {\n\t\t\t\twhile (len-- && dequal(foo[len], bar[len]));\n\t\t\t}\n\t\t\treturn len === -1;\n\t\t}\n\n\t\tif (!ctor || typeof foo === 'object') {\n\t\t\tlen = 0;\n\t\t\tfor (ctor in foo) {\n\t\t\t\tif (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;\n\t\t\t\tif (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) return false;\n\t\t\t}\n\t\t\treturn Object.keys(bar).length === len;\n\t\t}\n\t}\n\n\treturn foo !== foo && bar !== bar;\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","/**\n * @license React\n * use-sync-external-store-shim.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n\n          'use strict';\n\n/* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\nif (\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ !== 'undefined' &&\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart ===\n    'function'\n) {\n  __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error());\n}\n          var React = require('react');\n\nvar ReactSharedInternals = React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nfunction error(format) {\n  {\n    {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      printWarning('error', format, args);\n    }\n  }\n}\n\nfunction printWarning(level, format, args) {\n  // When changing this logic, you might want to also\n  // update consoleWithStackDev.www.js as well.\n  {\n    var ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n    var stack = ReactDebugCurrentFrame.getStackAddendum();\n\n    if (stack !== '') {\n      format += '%s';\n      args = args.concat([stack]);\n    } // eslint-disable-next-line react-internal/safe-string-coercion\n\n\n    var argsWithFormat = args.map(function (item) {\n      return String(item);\n    }); // Careful: RN currently depends on this prefix\n\n    argsWithFormat.unshift('Warning: ' + format); // We intentionally don't use spread (or .apply) directly because it\n    // breaks IE9: https://github.com/facebook/react/issues/13610\n    // eslint-disable-next-line react-internal/no-production-logging\n\n    Function.prototype.apply.call(console[level], console, argsWithFormat);\n  }\n}\n\n/**\n * inlined Object.is polyfill to avoid requiring consumers ship their own\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\nfunction is(x, y) {\n  return x === y && (x !== 0 || 1 / x === 1 / y) || x !== x && y !== y // eslint-disable-line no-self-compare\n  ;\n}\n\nvar objectIs = typeof Object.is === 'function' ? Object.is : is;\n\n// dispatch for CommonJS interop named imports.\n\nvar useState = React.useState,\n    useEffect = React.useEffect,\n    useLayoutEffect = React.useLayoutEffect,\n    useDebugValue = React.useDebugValue;\nvar didWarnOld18Alpha = false;\nvar didWarnUncachedGetSnapshot = false; // Disclaimer: This shim breaks many of the rules of React, and only works\n// because of a very particular set of implementation details and assumptions\n// -- change any one of them and it will break. The most important assumption\n// is that updates are always synchronous, because concurrent rendering is\n// only available in versions of React that also have a built-in\n// useSyncExternalStore API. And we only use this shim when the built-in API\n// does not exist.\n//\n// Do not assume that the clever hacks used by this hook also work in general.\n// The point of this shim is to replace the need for hacks by other libraries.\n\nfunction useSyncExternalStore(subscribe, getSnapshot, // Note: The shim does not use getServerSnapshot, because pre-18 versions of\n// React do not expose a way to check if we're hydrating. So users of the shim\n// will need to track that themselves and return the correct value\n// from `getSnapshot`.\ngetServerSnapshot) {\n  {\n    if (!didWarnOld18Alpha) {\n      if (React.startTransition !== undefined) {\n        didWarnOld18Alpha = true;\n\n        error('You are using an outdated, pre-release alpha of React 18 that ' + 'does not support useSyncExternalStore. The ' + 'use-sync-external-store shim will not work correctly. Upgrade ' + 'to a newer pre-release.');\n      }\n    }\n  } // Read the current snapshot from the store on every render. Again, this\n  // breaks the rules of React, and only works here because of specific\n  // implementation details, most importantly that updates are\n  // always synchronous.\n\n\n  var value = getSnapshot();\n\n  {\n    if (!didWarnUncachedGetSnapshot) {\n      var cachedValue = getSnapshot();\n\n      if (!objectIs(value, cachedValue)) {\n        error('The result of getSnapshot should be cached to avoid an infinite loop');\n\n        didWarnUncachedGetSnapshot = true;\n      }\n    }\n  } // Because updates are synchronous, we don't queue them. Instead we force a\n  // re-render whenever the subscribed state changes by updating an some\n  // arbitrary useState hook. Then, during render, we call getSnapshot to read\n  // the current value.\n  //\n  // Because we don't actually use the state returned by the useState hook, we\n  // can save a bit of memory by storing other stuff in that slot.\n  //\n  // To implement the early bailout, we need to track some things on a mutable\n  // object. Usually, we would put that in a useRef hook, but we can stash it in\n  // our useState hook instead.\n  //\n  // To force a re-render, we call forceUpdate({inst}). That works because the\n  // new object always fails an equality check.\n\n\n  var _useState = useState({\n    inst: {\n      value: value,\n      getSnapshot: getSnapshot\n    }\n  }),\n      inst = _useState[0].inst,\n      forceUpdate = _useState[1]; // Track the latest getSnapshot function with a ref. This needs to be updated\n  // in the layout phase so we can access it during the tearing check that\n  // happens on subscribe.\n\n\n  useLayoutEffect(function () {\n    inst.value = value;\n    inst.getSnapshot = getSnapshot; // Whenever getSnapshot or subscribe changes, we need to check in the\n    // commit phase if there was an interleaved mutation. In concurrent mode\n    // this can happen all the time, but even in synchronous mode, an earlier\n    // effect may have mutated the store.\n\n    if (checkIfSnapshotChanged(inst)) {\n      // Force a re-render.\n      forceUpdate({\n        inst: inst\n      });\n    }\n  }, [subscribe, value, getSnapshot]);\n  useEffect(function () {\n    // Check for changes right before subscribing. Subsequent changes will be\n    // detected in the subscription handler.\n    if (checkIfSnapshotChanged(inst)) {\n      // Force a re-render.\n      forceUpdate({\n        inst: inst\n      });\n    }\n\n    var handleStoreChange = function () {\n      // TODO: Because there is no cross-renderer API for batching updates, it's\n      // up to the consumer of this library to wrap their subscription event\n      // with unstable_batchedUpdates. Should we try to detect when this isn't\n      // the case and print a warning in development?\n      // The store changed. Check if the snapshot changed since the last time we\n      // read from the store.\n      if (checkIfSnapshotChanged(inst)) {\n        // Force a re-render.\n        forceUpdate({\n          inst: inst\n        });\n      }\n    }; // Subscribe to the store and return a clean-up function.\n\n\n    return subscribe(handleStoreChange);\n  }, [subscribe]);\n  useDebugValue(value);\n  return value;\n}\n\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  var prevValue = inst.value;\n\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(prevValue, nextValue);\n  } catch (error) {\n    return true;\n  }\n}\n\nfunction useSyncExternalStore$1(subscribe, getSnapshot, getServerSnapshot) {\n  // Note: The shim does not use getServerSnapshot, because pre-18 versions of\n  // React do not expose a way to check if we're hydrating. So users of the shim\n  // will need to track that themselves and return the correct value\n  // from `getSnapshot`.\n  return getSnapshot();\n}\n\nvar canUseDOM = !!(typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined');\n\nvar isServerEnvironment = !canUseDOM;\n\nvar shim = isServerEnvironment ? useSyncExternalStore$1 : useSyncExternalStore;\nvar useSyncExternalStore$2 = React.useSyncExternalStore !== undefined ? React.useSyncExternalStore : shim;\n\nexports.useSyncExternalStore = useSyncExternalStore$2;\n          /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\nif (\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ !== 'undefined' &&\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop ===\n    'function'\n) {\n  __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error());\n}\n        \n  })();\n}\n","import {\n  type Affinity,\n  type FunnelStage,\n  type OrderValue,\n  type PredictCoreApi,\n  type Segment,\n  type UserProfile,\n  type Zone,\n} from '@algolia/predict-core';\nimport { createContext } from 'react';\n\nexport type PredictReactApi = Omit<\n  PredictCoreApi,\n  | 'getAffinities'\n  | 'getFunnelStage'\n  | 'getOrderValue'\n  | 'getCartAbandonment'\n  | 'getSegments'\n  | 'getUserProfile'\n  | 'getZones'\n  | 'update'\n> & {\n  userProfile: UserProfile;\n  affinities: Affinity[];\n  funnelStage: FunnelStage[];\n  orderValue: OrderValue | undefined;\n  cartAbandonment: number;\n  segments: Segment[];\n  zones: Zone[];\n};\n\nexport const PredictContext = createContext<PredictReactApi | null>(null);\n\nif (__DEV__) {\n  PredictContext.displayName = 'Predict';\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import { createContext } from 'react';\n\ntype PredictZoneContextApi = {\n  dismissZone: () => void;\n};\n\nexport const PredictZoneContext = createContext<PredictZoneContextApi | null>(\n  null\n);\n\nif (__DEV__) {\n  PredictZoneContext.displayName = 'PredictZone';\n}\n","import { invariant } from '@algolia/predict-core';\nimport { useContext } from 'react';\n\nimport { PredictContext } from './PredictContext';\n\nexport function usePredictContext({\n  errorMessage = 'The Predict APIs must be used within the <Predict> provider.',\n} = {}) {\n  const context = useContext(PredictContext);\n\n  invariant(context !== null, errorMessage);\n\n  return context;\n}\n","import { type PredictReactApi } from './lib/PredictContext';\nimport { usePredictContext } from './lib/usePredictContext';\nimport { useStableValue } from './lib/useStableValue';\n\nexport type PredictApi = Omit<\n  PredictReactApi,\n  'addZone' | 'removeZone' | 'updateZone' | 'subscribe'\n>;\n\nexport function usePredict(): PredictApi {\n  const { addZone, removeZone, updateZone, subscribe, ...rest } =\n    usePredictContext({\n      errorMessage:\n        '`usePredict()` must be used within the <Predict> provider.',\n    });\n  const predictApi = useStableValue(rest);\n\n  return predictApi;\n}\n","import { dequal } from 'dequal/lite';\nimport { useState } from 'react';\n\nexport function useStableValue<TValue>(value: TValue) {\n  const [stableValue, setStableValue] = useState<TValue>(() => value);\n\n  if (!dequal(stableValue, value)) {\n    setStableValue(value);\n  }\n\n  return stableValue;\n}\n","import {\n  predict,\n  warn,\n  type PredictCoreApi,\n  type UserProfile,\n} from '@algolia/predict-core';\nimport { dequal } from 'dequal/lite';\nimport React, {\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { PredictContext, PredictReactApi } from './lib/PredictContext';\n\nexport type PredictProps = {\n  userProfile: UserProfile;\n  suppressExperimentalWarning?: boolean;\n  children: ReactNode;\n};\n\nexport function Predict({\n  userProfile,\n  suppressExperimentalWarning = false,\n  children,\n}: PredictProps) {\n  const predictRef = useRef<PredictCoreApi | null>(null);\n\n  if (predictRef.current === null) {\n    predictRef.current = predict({ userProfile });\n  }\n\n  const [predictApi, setPredictApi] = useState<PredictReactApi>(() => ({\n    userProfile: predictRef.current!.getUserProfile(),\n    affinities: predictRef.current!.getAffinities(),\n    funnelStage: predictRef.current!.getFunnelStage(),\n    orderValue: predictRef.current!.getOrderValue(),\n    cartAbandonment: predictRef.current!.getCartAbandonment(),\n    segments: predictRef.current!.getSegments(),\n    zones: predictRef.current!.getZones(),\n    addZone: predictRef.current!.addZone,\n    removeZone: predictRef.current!.removeZone,\n    updateZone: predictRef.current!.updateZone,\n    subscribe: predictRef.current!.subscribe,\n  }));\n\n  const [prevUserProfile, setPrevUserProfile] = useState(() =>\n    predictRef.current!.getUserProfile()\n  );\n  if (!dequal(userProfile, prevUserProfile)) {\n    predictRef.current.update({ userProfile });\n    setPrevUserProfile(userProfile);\n  }\n\n  const store = useSyncExternalStore(\n    useCallback(\n      () =>\n        predictRef.current!.subscribe(({ eventType, ...state }) => {\n          // We manage zone updates directly with the React state, so we don't\n          // need to listen to this event.\n          if (eventType !== 'ZONE_UPDATED') {\n            setPredictApi((prev) => ({ ...prev, ...state }));\n          }\n        }),\n      []\n    ),\n    () => predictApi,\n    () => predictApi\n  );\n\n  useEffect(() => {\n    warn(\n      suppressExperimentalWarning,\n      'This version is experimental and not production-ready.\\n\\n' +\n        'Please report any bugs at https://github.com/algolia/predict/issues/new\\n\\n' +\n        '(To disable this warning, pass `suppressExperimentalWarning` to <Predict>.)'\n    );\n  }, [suppressExperimentalWarning]);\n\n  return (\n    <PredictContext.Provider value={store}>{children}</PredictContext.Provider>\n  );\n}\n","import { createZone, type Zone } from '@algolia/predict-core';\nimport React, {\n  type ComponentProps,\n  type ReactNode,\n  useCallback,\n  useMemo,\n  useState,\n} from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { PredictZoneContext } from './lib/PredictZoneContext';\nimport { usePredictContext } from './lib/usePredictContext';\nimport { type PredictApi, usePredict } from './usePredict';\n\nexport type PredictZoneProps = Omit<\n  ComponentProps<'div'>,\n  'onMouseDown' | 'onTouchStart'\n> & {\n  id?: Zone['id'];\n  name: Zone['name'];\n  segment?: string | ((api: PredictApi) => boolean);\n  children: ReactNode;\n  fallback?: ReactNode;\n};\n\nexport function PredictZone({\n  id,\n  children,\n  name,\n  segment,\n  fallback = null,\n  ...props\n}: PredictZoneProps) {\n  const { addZone, removeZone, updateZone } = usePredictContext({\n    errorMessage:\n      'The <PredictZone> must be mounted within the <Predict> provider.',\n  });\n  const predictApi = usePredict();\n  const [zone, setZone] = useState(() => {\n    const active =\n      // eslint-disable-next-line no-nested-ternary\n      typeof segment === 'function'\n        ? segment(predictApi)\n        : segment\n        ? Boolean(predictApi.segments.find((s) => s.name === segment))\n        : true;\n    return createZone({ id, name, active });\n  });\n  const [isDismissed, setIsDismissed] = useState(false);\n\n  const [prevName, setPrevName] = useState(zone.name);\n  if (name !== prevName) {\n    setPrevName(name);\n    updateZone({ id: zone.id, name });\n  }\n\n  if (!isDismissed) {\n    const active =\n      // eslint-disable-next-line no-nested-ternary\n      typeof segment === 'function'\n        ? segment(predictApi)\n        : segment\n        ? Boolean(predictApi.segments.find((s) => s.name === segment))\n        : zone.active;\n\n    if (active !== zone.active) {\n      setZone((prev) => ({ ...prev, active }));\n      updateZone({ id: zone.id, active });\n    }\n  }\n\n  const zoneApi = useMemo(\n    () => ({\n      dismissZone: () => {\n        setZone((prev) => ({ ...prev, active: false, happened: true }));\n        updateZone({ id: zone.id, active: false, happened: true });\n        setIsDismissed(true);\n      },\n    }),\n    [updateZone, zone.id]\n  );\n\n  const zoneStore = useSyncExternalStore(\n    useCallback(() => {\n      addZone(zone);\n\n      return () => {\n        removeZone(zone);\n      };\n      // We don't track zone changes because we update the zone in the store via\n      // `updateZone()`.\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [addZone, removeZone]),\n    () => zoneApi,\n    () => zoneApi\n  );\n\n  if (!zone.active) {\n    return <>{fallback}</>;\n  }\n\n  return (\n    <PredictZoneContext.Provider value={zoneStore}>\n      <div\n        {...props}\n        data-predictzoneid={zone.id}\n        onMouseDown={() => {\n          setZone((prev) => ({ ...prev, happened: true }));\n          updateZone({ id: zone.id, happened: true });\n        }}\n        onTouchStart={() => {\n          setZone((prev) => ({ ...prev, happened: true }));\n          updateZone({ id: zone.id, happened: true });\n        }}\n      >\n        {children}\n      </div>\n    </PredictZoneContext.Provider>\n  );\n}\n","import { invariant } from '@algolia/predict-core';\nimport { useContext } from 'react';\n\nimport { PredictZoneContext } from './lib/PredictZoneContext';\n\nexport function usePredictZone() {\n  const context = useContext(PredictZoneContext);\n\n  invariant(\n    context !== null,\n    '`usePredictZone()` must be used within a <PredictZone>.'\n  );\n\n  return context;\n}\n","export const version = '1.4.0';\n"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_objectWithoutProperties","source","excluded","i","target","sourceKeys","keys","length","indexOf","objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","_arrayLikeToArray","arr","len","arr2","Array","_slicedToArray","isArray","arrayWithHoles","_i","Symbol","iterator","_s","_e","_arr","_n","_d","next","done","push","err","iterableToArrayLimit","o","minLen","arrayLikeToArray","n","toString","slice","constructor","name","from","test","unsupportedIterableToArray","TypeError","nonIterableRest","zoneCounterRef","current","invariant","condition","message","process","env","NODE_ENV","Error","concat","warnCache","warn","sanitizedMessage","trim","warning","console","error","unwrapPrediction","predictions","model","fallback","prediction","Boolean","isModelError","ownKeys","object","enumerableOnly","symbols","filter","sym","getOwnPropertyDescriptor","apply","_objectSpread","arguments","forEach","getOwnPropertyDescriptors","defineProperties","highlighter","highlights","unselect","id","overlay","document","body","removeChild","select","referenceElement","props","_referenceElement$get","getBoundingClientRect","height","width","top","left","createElement","setAttribute","style","attribute","appendChild","unselectAll","createElementHighlighter","runAction","_ref","init","type","data","actions","_ref2","zoneId","params","predictZoneElement","querySelector","_ref3","_ref4","scrollIntoViewIfNeeded","bind","scrollIntoView","disconnect","action","_excluded","sendMessage","window","postMessage","predict","subscribers","userProfile","zones","getUserProfile","getSegments","entries","segments","reduce","acc","segment","map","segmentInType","getAffinities","getFunnelStage","getOrderValue","undefined","getCartAbandonment","funnelStage","addToCartFunnelStage","find","x","transactionFunnelStage","probability","getZones","subscribe","subscriber","notify","eventType","affinities","cartAbandonment","orderValue","PREDICT_TOOLS","version","getContext","context","addEventListener","event","initPredictTools","update","nextParams","addZone","newZone","removeZone","zone","zoneIndex","findIndex","splice","updateZone","_zone$name","_zone$active","_zone$happened","prevZone","updatedZone","active","happened","has","hasOwnProperty","dequal","foo","bar","ctor","Date","getTime","RegExp","module","exports","e","require$$0","k","is","a","b","l","useState","m","useEffect","useLayoutEffect","p","useDebugValue","r","getSnapshot","d","f","u","inst","c","g","useSyncExternalStoreShim_production_min","useSyncExternalStore","__REACT_DEVTOOLS_GLOBAL_HOOK__","registerInternalModuleStart","React","ReactSharedInternals","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","format","_len2","args","_key2","printWarning","level","stack","ReactDebugCurrentFrame","getStackAddendum","argsWithFormat","item","String","unshift","Function","objectIs","y","didWarnOld18Alpha","didWarnUncachedGetSnapshot","checkIfSnapshotChanged","latestGetSnapshot","prevValue","nextValue","shim","getServerSnapshot","startTransition","cachedValue","_useState","forceUpdate","useSyncExternalStore$2","useSyncExternalStoreShim_development","registerInternalModuleStop","PredictContext","createContext","_extends","assign","this","PredictZoneContext","usePredictContext","_ref$errorMessage","errorMessage","useContext","usePredict","_usePredictContext","_useState2","stableValue","setStableValue","rest","_ref$suppressExperime","suppressExperimentalWarning","children","predictRef","useRef","predictApi","setPredictApi","_useState4","prevUserProfile","setPrevUserProfile","store","useCallback","state","prev","Provider","_ref$fallback","s","_ref$active","_ref$happened","createZone","setZone","isDismissed","setIsDismissed","_useState6","prevName","setPrevName","zoneApi","useMemo","dismissZone","zoneStore","onMouseDown","onTouchStart","Fragment"],"mappings":"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"}